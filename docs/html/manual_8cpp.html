<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RT1 - Final Assignment: src/manual.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RT1 - Final Assignment
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">ROS package for controlling a mobile robot in a simulated environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">manual.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manual controller of the robot.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &quot;ros/ros.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Twist.h&quot;</code><br />
<code>#include &quot;sensor_msgs/LaserScan.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for manual.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="manual_8cpp__incl.png" border="0" usemap="#src_2manual_8cpp" alt=""/></div>
<map name="src_2manual_8cpp" id="src_2manual_8cpp">
<area shape="rect" title="Manual controller of the robot." alt="" coords="165,5,286,32"/>
<area shape="rect" title=" " alt="" coords="5,80,85,107"/>
<area shape="rect" title=" " alt="" coords="110,80,189,107"/>
<area shape="rect" title=" " alt="" coords="213,80,389,107"/>
<area shape="rect" title=" " alt="" coords="413,80,603,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa4d1dd299d39287a05983faf79e4fd7d"><td class="memItemLeft" align="right" valign="top"><a id="aa4d1dd299d39287a05983faf79e4fd7d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#aa4d1dd299d39287a05983faf79e4fd7d">WALL_TH</a>&#160;&#160;&#160;0.8</td></tr>
<tr class="memdesc:aa4d1dd299d39287a05983faf79e4fd7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Threshold distance from the wall to not be exceeded when the collision assistan is on. <br  />
 <br /></td></tr>
<tr class="separator:aa4d1dd299d39287a05983faf79e4fd7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of the manual node.  <a href="manual_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60e6d5e952ea263ffd664435526673ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#a60e6d5e952ea263ffd664435526673ed">manualDrive</a> ()</td></tr>
<tr class="memdesc:a60e6d5e952ea263ffd664435526673ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manual drive function.  <a href="manual_8cpp.html#a60e6d5e952ea263ffd664435526673ed">More...</a><br /></td></tr>
<tr class="separator:a60e6d5e952ea263ffd664435526673ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc61c6bd4cc1f1aa51c6a270e390c38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#accc61c6bd4cc1f1aa51c6a270e390c38">checkVel</a> (const geometry_msgs::Twist::ConstPtr &amp;msg)</td></tr>
<tr class="memdesc:accc61c6bd4cc1f1aa51c6a270e390c38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function of /check_vel topic.  <a href="manual_8cpp.html#accc61c6bd4cc1f1aa51c6a270e390c38">More...</a><br /></td></tr>
<tr class="separator:accc61c6bd4cc1f1aa51c6a270e390c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060d2b1bc6a85691b04df56b7e399e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#a060d2b1bc6a85691b04df56b7e399e7a">drivingAssistant</a> (const sensor_msgs::LaserScan::ConstPtr &amp;laserMsg)</td></tr>
<tr class="memdesc:a060d2b1bc6a85691b04df56b7e399e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function of /scan topic (LaserScan)  <a href="manual_8cpp.html#a060d2b1bc6a85691b04df56b7e399e7a">More...</a><br /></td></tr>
<tr class="separator:a060d2b1bc6a85691b04df56b7e399e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac0664a23d360105ec3d579965d5b7631"><td class="memItemLeft" align="right" valign="top"><a id="ac0664a23d360105ec3d579965d5b7631"></a>
ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#ac0664a23d360105ec3d579965d5b7631">pub_vel</a></td></tr>
<tr class="memdesc:ac0664a23d360105ec3d579965d5b7631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global publisher to send velocities. <br /></td></tr>
<tr class="separator:ac0664a23d360105ec3d579965d5b7631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6f6b880e1b04dbcf84d6ccbfe1efaa"><td class="memItemLeft" align="right" valign="top"><a id="abd6f6b880e1b04dbcf84d6ccbfe1efaa"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#abd6f6b880e1b04dbcf84d6ccbfe1efaa">assistant</a> = false</td></tr>
<tr class="memdesc:abd6f6b880e1b04dbcf84d6ccbfe1efaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global boolean defining if the collision assistant is on/off. <br /></td></tr>
<tr class="separator:abd6f6b880e1b04dbcf84d6ccbfe1efaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a511b3d224c1d6e07e2884ce294238ccc"><td class="memItemLeft" align="right" valign="top"><a id="a511b3d224c1d6e07e2884ce294238ccc"></a>
geometry_msgs::Twist&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="manual_8cpp.html#a511b3d224c1d6e07e2884ce294238ccc">myVel</a></td></tr>
<tr class="memdesc:a511b3d224c1d6e07e2884ce294238ccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global velocity message. <br /></td></tr>
<tr class="separator:a511b3d224c1d6e07e2884ce294238ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manual controller of the robot. </p>
<dl class="section author"><dt>Author</dt><dd>Mohammad Al Horany </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10/04/2022</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">assistant</td><td>Defines if the collision avoidance is on.</td></tr>
  </table>
  </dd>
</dl>
<p>Subscribes to: <br  />
 /check_vel It contains the velocity to be sent to the robot /scan It contains the laser scan ranges</p>
<p>Publishes to: <br  />
 /cmd_vel It sends the velocity to the robot</p>
<p>Description : This is the node that allows the user to control the robot with the keyboard, via 'teleop_twist_keyboard', runned in another console. If the collision assistant is off, it simply publishes velocities as received, so the user can even go straight to an obstacle. If the collision assistant is on, it receives velocities and laser scan ranges, and checks if the user is going in a direction where there are obstacles more near than a certain threshold (0.8). In this case, it sets the velocity (linear/angular) pointing to the obstacle to 0. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="accc61c6bd4cc1f1aa51c6a270e390c38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc61c6bd4cc1f1aa51c6a270e390c38">&#9670;&nbsp;</a></span>checkVel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void checkVel </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::Twist::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function of /check_vel topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Robot's velocity</td></tr>
  </table>
  </dd>
</dl>
<p>This function is called whenever the teleop twist keyboard node tries to send a new velocity:</p><ul>
<li>COLLISION ASSISTANT OFF --&gt; it publishes the velocity as received in /cmd_vel topic</li>
<li>COLLISION ASSISTANT ON --&gt; it saves the velocity in a global variable </li>
</ul>

</div>
</div>
<a id="a060d2b1bc6a85691b04df56b7e399e7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060d2b1bc6a85691b04df56b7e399e7a">&#9670;&nbsp;</a></span>drivingAssistant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drivingAssistant </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::LaserScan::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>laserMsg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function of /scan topic (LaserScan) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">laserMsg</td><td>Robot's laser scan</td></tr>
  </table>
  </dd>
</dl>
<p>This function is called at every message on the /scan topic:</p><ul>
<li>COLLISION ASSISTANT OFF --&gt; it ignores the message and returns</li>
<li>COLLISION ASSISTANT ON --&gt; it stops the robot motion along a certain direction if there is a wall near in that direction and publishes the velocity in /cmd_vel topic </li>
</ul>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function of the manual node. </p>
<p>This is the main function of the manual mode. It initializes the node, subscribes to "/check_vel" and "/scan" topics and defines a publisher on "/cmd_vel". After that, it gets the parameter "collisionAssistant" from the parameter server and puts it in a global variable. It calls the "manualDrive" function which returns if the user presses a key, so the main function can shutdown the node. </p>

</div>
</div>
<a id="a60e6d5e952ea263ffd664435526673ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60e6d5e952ea263ffd664435526673ed">&#9670;&nbsp;</a></span>manualDrive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manualDrive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manual drive function. </p>
<p>This function is called when the user choose the manual driving mode. It prints an informational output and waits for an input to exit the manual mode and shutdown the node. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
